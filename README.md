
# APA_PKMZ

This repository contains the analysis code and data for the *Active Place Avoidance (APA)* experiment, integrating behavioral and bulk RNA-seq datasets from mice.

Experimental and biological details are described in the accompanying manuscript : https://www.biorxiv.org/content/10.1101/2025.04.28.651143v2 

> **Note**: Some previous codes written by Rayna Harris (https://github.com/raynamharris/IntegrativeProjectWT2015) are not included here.  
> For example, the UNIX scripts used to process the raw RNA-seq data on the Stampede cluster at the Texas Advanced Computing Facility are excluded.

The package/library versions are also described in the main manuscript. 

---

## Repository Structure

The repository is organized into the following main directories:

- `codes/` – All R and Python scripts for statistical analysis and data visualization.  
  Script filenames are prefixed by numbers to indicate their execution order.
- `figures/` – All figures generated by the scripts.
- `data/` – Input datasets and result files.

---

## Analysis Overview

### Part 1: Behavioral Analysis
- **Language**: Python  
- **Path**: `codes/01.behavior_analysis`  
  Includes behavioral statistics and data visualization.

### Part 2: RNA-seq Differential Expression
- **Language**: R  
- **Path**: `codes/02.DEG_analysis`  
  Differential gene expression analysis using DESeq2.

### Part 3: Integrated Behavior–Expression Analysis
- **Language**: Python  
- **Scripts**:
  - `codes/03.Behavior_expression`: Merges behavioral and gene expression data.
  - `codes/04.01.new_method`: Main analysis pipeline for generating linear/non-linear correlation scores and Louvain clustering.
  - `codes/04.02.anchor_based_method`: Computes co-cluster probabilities based on anchor genes (Arc, Nsf, Prkcz).
  - `codes/06.Robust_check`: Assesses the robustness of DEG-based rankings using three independent metrics.
  - `codes/07.Additional_fig`: Generates supplementary figures.

- **Language**: R  
- **Script**:
  - `codes/05.WGCNA`: Performs WGCNA using both Pearson and xi-correlation.

---

Please refer to individual script headers and comments for additional methodological details.
